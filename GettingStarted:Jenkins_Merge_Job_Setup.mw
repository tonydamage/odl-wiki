== Introduction ==

The purpose of the Merge Job is to make sure that the branch (usually master) is still healthy after the merge
of a new patch and to publish all the binary artifacts to the Nexus Repo (so we have fresh SNAPSHOTS that match the branch)
so others can consume them.

== Caveats ==

'''Note:''' to complete these steps you will need to be a committer on the project for which you are doing it.

'''Note:''' in all examples given below, '''repo_name''' is used a stand in for the repo name of your project and
'''project_name''' is the name of your project. Please substitute appropriately.

'''Note:''' For the deployment to Nexus to work the groupid in all of your projects pom.xml files must be 

<groupid>org.opendaylight.repo_name</groupid>

due to permission restrictions on Nexus.  If you need to do something different, please contact helpdesk@opendaylight.org.

'''Note:''' These instructions presume you have already [[GettingStarted:Jenkins Verify Job Setup|Setup your Jenkins Verify Job]]

== Detailed Steps ==

# Navigate to the Jenkins for your project by going to http://jenkins.opendaylight.org/repo_name/
# Log in
#: [[File:Jenkins Verify Job Setup - Log In.jpg|800px]]
# Click on "New Job"
#: [[File:Jenkins Verify Job - New Job.jpg|800px]]
## Name your Job repo_name-merge (examples: controller-verify, vtn-verify, etc).
## Select '''Copy existing Job''' as your Job Type 
## Enter "repo_name-verify" in "Copy from"
## Click '''OK'''.
##: [[File:Jenkins Merge Job - Job Name.jpg|800px]]
# Scroll down to "Gerrit Trigger" -> "Trigger on" 
## Delete "PatchSet Created" and "Draft Published"
##: [[File:Jenkins Merge Job - Delete Triggers.jpg|800px]]
## Click "Add" and select "Change Merged"
[[File:Jenkins Merge Job - Add Trigger.jpg|800px]]
# Scroll down to "Post Steps"
## Select "Run only if build succeeds"
## Click "Add post-build step" and select "Invoke top-level Maven targets"
##: [[File:Jenkins Merge Job - Post Steps 1.jpg|800px]]
## Select "Maven Version" "3.0.4"
## Enter "Goal" "Deploy"
## Click "Advanced"
##: [[File:Jenkins Merge Job - Post Steps 2.jpg|800px]]
## In "POM" enter your root pom file (for example commons/parent/pom.xml )
## In "Properties" enter 
<pre>
maven.repo.local=$WORKSPACE/.m2repo
org.ops4j.pax.url.mvn.localRepository=$WORKSPACE/.m2repo
</pre>
## In "JVM Options" enter 
<pre>
-Xmx1024m
-XX:MaxPermSize=256m
</pre>
## Click "Save"
##: [[File:Jenkins Merge Job - Post Steps 3.jpg|800px]]
