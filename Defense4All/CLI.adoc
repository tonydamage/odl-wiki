Back to Defense4All:User_Guide[Defense4All User Guide Page]

[[defense4all-cli-overview]]
= Defense4All CLI Overview

Defense4all Command-Line Interface (CLI) is a management interface for
running configuration commands and obtaining statistics and monitoring
information. The CLI is packaged along with Defense4all server by
default. The CLI can be accessed through the console window or by using
ssh to connect to the virtual machine or host where Defense4all is
installed.

*CLI Location*

The CLI - “controlapps” - is located in

` /usr/share/defense4all/bin/`

It can be run by either

` $ /usr/share/defense4all/bin/controlapps`

Or

` $ cd /usr/share/defense4all/bin` +
` $ ./controlapps`

*CLI Syntax* - General syntax of CLI command is

` $ controlapps <command> [parameters]` +
`   where` +
`      <command> is one of predefined commands` +
`      [parameters] is list of parameters suitable for specific command.`

*Parameter rules:*

` Parameters for most of the commands are formed - field_name=field_value` +
` A composite field names are formed - composite_field::sub_composite_field=sub_composite_field_value.` +
` A field in composite list element - list_name::list_element_label::composite_field::sub_composite_field=value.`

[[obtaining-list-of-supported-commands]]
= Obtaining list of supported commands

'''Description '''- Obtaining list of supported commands

'''Syntax '''-

`controlapps help`

*Parameters* - none

*Result* - list of supported commands

*Remarks* - none.

[[obtaining-help-for-specific-command]]
= Obtaining help for specific command

'''Description '''- Obtaining help for specific command

'''Syntax '''-

`controlapps help `*`command`*

'''Result '''- usage and list of required parameters for specific
command

*Remarks* - none.

[cols=",,",]
|=======================================================================
|*Parameter* |*Description* |*Valid Value*

|*command* |one of supported command |See output of controlapps help
command
|=======================================================================

[[set-defense4all-host-address]]
= Set Defense4All host address

*Description* - sets in local controlapps instance the IP address of the
(virtual) machine hosting it.

'''Syntax '''-

`controlapps sethostaddr `*`hostaddress`*

'''Result '''- Confirmation or error message

'''Remarks '''- none.

[cols=",,",]
|=======================================================================
|*Parameter* |*Description* |*Valid Value*

|*hostaddress* |IP address of the machine on which Defense4All is run
|Hostname or IP address in CIDR or address-mask format
|=======================================================================

[[get-defense4all-host-address]]
= Get Defense4All host address

*Description* - Gets the IP address of the machine on which Defense4All
is run.

'''Syntax '''-

`controlapps gethostaddr`

*Parameters* - none

'''Result '''- hostaddr = *hostaddress*

*Remarks* - none.

[[terminate-defense4all]]
= Terminate Defense4All

*Description* - Terminate Defense4All.

'''Syntax '''-

`controlapps terminate `*`scope`*

'''Result '''- Initiating terminate *scope*

*Remarks* - In this version Defense4All is not clustered, so “this” and
“cluster” mean the same thing.

[cols=",,",]
|=======================================================================
|*Parameter* |*Description* |*Valid Value*

|*scope* |Scope of termination – this instance or entire Defense4All
cluster a|
“this” – this instance (default if no scope provided).

“cluster” – entire Defense4All cluster

|=======================================================================

[[reset-defense4all]]
= Reset Defense4All

*Description* – Reset Defense4All.

'''Syntax '''-

`controlapps reset `*`level`*

_'Result *- Initiating reset* level_'

*Remarks* - In this version all resets are treated as factory reset.
More granular resets are to be supported in future versions.

[cols=",,",]
|=======================================================================
|*Parameter* |*Description* |*Valid Value*

|*level* |Level of reset to perform a|
“soft” – Reset easily reconstructable dynamic state (e.g., latest
traffic statistics, network topology).

“dynamic” – In addition to “soft”, reset all dynamic state portions,
including the not easily reconstructable (e.g., traffic baselines).

“factory” - Full reset of both dynamic state as well as user
configurations

|=======================================================================

[[get-selected-flight-recorder-events]]
= Get Selected Flight Recorder Events

*Description* - Get an optionally limited by number flight recorded
events matching an optional specification of filters (event categories)
and date-time range.

'''Syntax '''-

`controlapps frevents fromDate=`*`fromDate`*` toDate=`*`toDate`*` maxNum=`*`maxNum`*` filter=`*`filterList`*

'''Result '''- List of records in format : *eventTime eventType
eventData*

*Remarks* - none.

[cols=",,",]
|=======================================================================
|*Parameter* |*Description* |*Valid Value*

|*maxNum* |Max number of event records to return. Optional, if not
specified 2147483647 is assumed. |Number.

|*fromDate* |Earliest events date-time |Example: 10/13/2013_16:55:00

|*toDate* |Latest events date-time |Example: 10/20/2013_16:55:00

|*filterList* a|
List of textual filters. Optional. If not specified all categories of
events are assumed.

Filter names: _DF_ stands for Defense4All, _AMS_ stands for Attack
Mitigation System, _OFC_ stands for OpenDaylight Controller. _config_
events record user configurations. _operational_ events record
informational runtime data. _failure_ events record failures. _security_
events record information about security detections, attacks and
mitigations, as well as monitored traffic periodically recorded
baselines.

 a|
Filter example: DF_security,AMS_security

Valid Filters:

Framework_config, Framework_operational, Framework_failure, DF_config,
DF_operational, DF_failure, DF_security, AMS_operational, AMS_failure,
AMS_security, OFC_operational, OFC_failure

|=======================================================================

[cols=",,",]
|=======================================================================
|*Result Element* |*Description* |*Valid Value*

|*eventTime* |Time of the event |String value of the number of
milliseconds since January 1, 1970, 00:00:00 GMT

|*eventType* |Event type (category) |See filterList above.

|*eventData* |Textual event description |String.
|=======================================================================

[[get-latest-flight-recorder-events]]
= Get Latest Flight Recorder Events

*Description* – Get an optionally limited by number flight recorded
events matching an optional specification of filters (event categories).

'''Syntax '''-

`controlapps frlatest maxNum=`*`maxNum`*` filter=`*`filterList`*

'''Result '''- List of records in format : *eventTime eventType
eventData*

*Remarks* - none.

[cols=",,",]
|=======================================================================
|*Request Element* |*Description* |*Valid Value*

|*maxNum* |Max number of event records to return. Optional, if not
specified 2147483647 is assumed. |Number.

|*filterList* a|
List of textual filters. Optional. If not specified all categories of
events are assumed.

Filter names: DF stands for Defense4All, AMS stands for Attack
Mitigation System, OFC stands for OpenDaylight Controller. config events
record user configurations. operational events record informational
runtime data. failure events record failures. security events record
information about security detections, attacks and mitigations, as well
as monitored traffic periodically recorded baselines.

 a|
Filter example: DF_security,AMS_security

Valid Filters:

Framework_config, Framework_operational, Framework_failure, DF_config,
DF_operational, DF_failure, DF_security, AMS_operational, AMS_failure,
AMS_security, OFC_operational, OFC_failure

|=======================================================================

[cols=",,",]
|=======================================================================
|*Result Element* |*Description* |*Valid Value*

|*eventTime* |Time of the event |String value of the number of
milliseconds since January 1, 1970, 00:00:00 GMT

|*eventType* |Event type (category) |See filterList above.

|*eventData* |Textual event description |String.
|=======================================================================

[[dump-flight-recorder-events]]
= Dump Flight Recorder Events

*Description* – Dump to file and delete from Flight Recorder logs a set
of recorded events. The events are optionally limited by number,
optionally match one of specified filters (event categories), and have
an optional date-time range.

'''Syntax '''-

`controlapps frdump toFile=`*`toFile`*` fromDate=`*`fromDate`*` toDate=`*`toDate`*` maxNum=`*`maxNum`*` filter=`*`filterList`*

'''Result '''- Initiating dump to *fileName*

*Remarks* - none.

[cols=",,",]
|=======================================================================
|*Parameter* |*Description* |*Valid Value*

|*maxNum* |Max number of event records to return. Optional, if not
specified 2147483647 is assumed. |Number.

|*fromDate* |Earliest events date-time |Example: 10/13/2013_16:55:00

|*toDate* |Latest events date-time |Example: 10/20/2013_16:55:00

|*filterList* a|
List of textual filters. Optional. If not specified all categories of
events are assumed.

Filter names: _DF_ stands for Defense4All, _AMS_ stands for Attack
Mitigation System, _OFC_ stands for OpenDaylight Controller. _config_
events record user configurations. _operational_ events record
informational runtime data. _failure_ events record failures. _security_
events record information about security detections, attacks and
mitigations, as well as monitored traffic periodically recorded
baselines.

 a|
Filter example: DF_security,AMS_security

Valid Filters:

Framework_config, Framework_operational, Framework_failure, DF_config,
DF_operational, DF_failure, DF_security, AMS_operational, AMS_failure,
AMS_security, OFC_operational, OFC_failure

|*toFile* |Name of the file to write event records to. |String. File
name.
|=======================================================================

[cols=",,",]
|=======================================================================
|*Result Element* |*Description* |*Valid Value*

|*filename* |The name of the file into which the event records were
written |String. File name.
|=======================================================================

[[cleanup-flight-recorder-events]]
= Cleanup Flight Recorder Events

*Description* – Cleanup (delete) from Flight Recorder logs a set of
recorded events older than specified number of days ago.

'''Syntax '''-

`controlapps frcleanup olderDays=`*`olderDays`*

'''Result '''- Initiating cleanup

*Remarks* - none.

[cols=",,",]
|=======================================================================
|*Parameter* |*Description* |*Valid Value*

|*olderDays* |Delete all events dated '''olderDays '''ago or more
|Number
|=======================================================================

[[get-pns]]
= Get PNs

*Description* – Get the configuration information of all PNs.

'''Syntax '''-

`controlapps getpns `

'''Result '''–

` [` +
`     `*`PN_RECORD`* +
` ]`

*Remarks* – none.

[cols=",,",]
|=====================================================
|*Result Element* |*Description* |*Valid Value*
|*PN_RECORD* |PN Information. See get PN for details |
|=====================================================

[[get-pns-count]]
= Get PNs Count

*Description* – Get the number of configured PNs.

'''Syntax '''-

`controlapps getpnscount`

'''Result '''- There are *count* PNs known to DF.

*Remarks* – none.

[cols=",,",]
|==============================================
|*Result Element* |*Description* |*Valid Value*
|*count* |The number of existing PNs |Number
|==============================================

[[get-pn]]
= Get PN

*Description* – Get the configuration information of a PN.

'''Syntax '''-

`controlapps getpn `*`label`*

_'Result *-* *PN[label=*label*, ipVersion=*ipVersion*,
dstAddr=*dstAddr*, dstAddrPrefixLen=*dstAddrPrefixLen*,
virtualNetid=*virtualNetid*,
amsConfigProps=\{*amsConfigPropertyName*:*amsConfigPropertyValue*},
protectionSLA=*protectionSLA*,
mitigationConfirmation=*mitigationConfirmation*,
detectorLabel=*detectorLabel*, ofBasedDetection=*ofBasedDetection*,
symmetricDvsn=*symmetricDvsn*,
anomalyThresholdPercentage=*anomalyThresholdPercentage*,
mitigationScope=*mitigationScope*, netNodeLabel=*netNodeLabel*,
props=\{*propertyName*:*propertyValue_'}]

*Remarks* - See Remarks in Add PN.

[cols=",,",]
|=======================================================================
|*Parameter* |*Description* |*Valid Value*

|*label* |PN label |Textual value of size less than 100 bytes, starting
with a letter
|=======================================================================

[cols=",,",]
|=======================================================================
|*Result Element* |*Description* |*Valid Value*

|*label* |PN unique label |String up to 256 bytes.

|*ipVersion* |IP Version |*IPV4* | *IPV6*

|*dstAddr* |Protected destination address prefix |String format
compatible with Java InetAddress.getByName(). If hostname is specified,
then its IP address is resolved. The address can also be specified as
textual IP representation (V4 or V6 format), or address number. The
protected address range is the subnet of size *dstAddressPrefixLen*
containing the address.

|*dstAddrPrefixLen* |Protected destination address prefix length |Number

|*virtualNetid* |Id of a virtual network in which the PN lives.
Optional. Examples: VLAN, NEC VTN |String

|*protectionSLA* |Service Level Agreement for this PN |Currently empty

|*mitigationConfirmation* |Indicator whether user confirmation is needed
for mitigation of an attack (e.g., traffic redirection to a mitigation
device). |'''true '''| *false*

|*detectorLabel* |Label of desired detector of attacks for this PN |For
detection based on stats collected from Controller
“of_rate_based_detector” should appear.

|*ofBasedDetection* |Indicator whether detection is based on stats
collected from ODC. |'''true '''| *false*

|*symmetricDvsn* |Indicator whether upon attack mitigation traffic
redirection should be done both for inbound (to protected servers) and
outbound traffic (back from protected servers). |'''true '''| *false*

|*anomallyThresholdPercentage* |Percentage of deviation of current
traffic rate from baselines triggering detection of attack in the. Can
be either in bytes or packets per second for each protocol portion of
the traffic (see protocol). |Number.

|*pnCanceled* |Indicator whether the PN has been logically deleted (and
appears only for recording and analysis purposes). |Boolean.

|*mitigationScope* |Indicator what portion of the traffic is to be
mitigated (redirected to mitigation device). a|
'''ALL '''– all PN traffic should be mitigated.

*ATTACKED* - only the attacked portion (e.g., tcp) should be mitigated.

|*netNodeLabel* |Label of a NetNode relevant to protection of this PN.
Please refer to remarks. |String

|*amsConfigPropertyName* |Name of AMS configuration property. AMS
specific – please refer to remarks below. |String

|*amsConfigPropertyValue* |Value of AMS configuration property. AMS
specific – please refer to remarks. |String

|*propertyName* |Name of general configuration property. Please refer to
remarks. |String

|*propertyValue* |Name of general configuration property. Please refer
to remarks. |String
|=======================================================================

[[add-pn]]
= Add PN

*Description* – Configure a PN in Defense4All.

'''Syntax '''-

`controlapps addpn label=`*`label`*` ipVersion=`*`ipVersion`*` dstAddr=`*`dstAddr`*`  dstAddrPrefixLen=`*`dstAddrPrefixLen`*` virtualNetid='''virtualNetid '''` +
`protectionSLA=`_`'protectionSLA`
*`mitigationConfirmation=`*`mitigationConfirmation`_`' detectorLabel=`*`detectorLabel`*`ofBasedDetection='''ofBasedDetection '''` +
`symmetricDvsn=`_`'symmetricDvsn`
*`anomalyThresholdPercentage=`*`anomalyThresholdPercentage`_`' mitigationScope=`*`mitigationScope`*` props::`*`propertyName`*`=`*`propertyValue`* +
`amsConfigProps::`*`amsConfigPropertyName`*`=`_`'amsConfigPropertyValue`
*`netNodeLabel=`*`netNodeLabel`_`'`

'''Result '''- Confirmation or error message

*Remarks* –

1.  Defining PNs with overlapping destination addresses should be
avoided (may lead to unpredictable results).
2.  Configuration properties - Because Defense4All is a pluggable
application and framework, its general REST API must not include any
component specific configurations as named parameters in PN. To allow
configuration of pluggable components the notion of configuration
properties is used. Any configuration setup, specific to a pluggable
component should be configured as a property carrying a unique property
name. *amsConfigProps* properties are optional AMS configuration
properties, specific per each AMS. Read AMS specific documentation to
see what properties should be set. The reference AMS implementation over
Radware DefensePro uses default configuration and therefore does not
require configuration properties. *Props* are optional configuration
properties of all other pluggable components (like additional future
pluggable attack detectors, mitigation drivers, or versions of ODC).
3.  Specified NetNodes - NetNodes through which PN traffic normally
flows (if not redirected), NetNodes to which AMSs relevant to this PN
attack mitigation are connected, or both. Defense4All places traffic
counters on NetNodes with traffic ports. It diverts attacked PN traffic
to one/some of the AMSs connected to NetNodes in this set.

[cols=",,",]
|=======================================================================
|*Parameter* |*Description* |*Valid Value*

|*label* |PN unique label |String up to 256 bytes.

|*ipVersion* |IP Version |IPV4 | IPV6

|*dstAddr* |Protected destination address prefix |String format
compatible with Java InetAddress.getByName(). If hostname is specified,
then its IP address is resolved. The address can also be specified as
textual IP representation (V4 or V6 format), or address number. The
protected address range is the subnet of size *dstAddressPrefixLen*
containing the address.

|*dstAddrPrefixLen* |Protected destination address prefix length |Number

|*virtualNetid* |Id of a virtual network in which the PN lives.
Optional. Examples: VLAN, NEC VTN |String

|*protectionSLA* |Service Level Agreement for this PN |Currently empty

|*mitigationConfirmation* |Indicator whether user confirmation is needed
for mitigation of an attack (e.g., traffic redirection to a mitigation
device). |*True |* '''false '''(default)

|*detectorLabel* |Label of desired detector of attacks for this PN |For
detection based on stats collected from Controller
“of_rate_based_detector” should appear.

|*ofBasedDetection* |Indicator whether detection is based on stats
collected from ODC. |*True |* '''false '''(default)

|*symmetricDvsn* |Indicator whether upon attack mitigation traffic
redirection should be done both for inbound (to protected servers) and
outbound traffic (back from protected servers). |*True |* '''false
'''(default)

|*anomallyThresholdPercentage* |Percentage of deviation of current
traffic rate from baselines triggering detection of attack in the. Can
be either in bytes or packets per second for each protocol portion of
the traffic (see protocol). |Number

|*mitigationScope* |Indicator what portion of the traffic is to be
mitigated (redirected to mitigation device). a|
'''ALL '''– all PN traffic should be mitigated.

*ATTACKED* - (default) only the attacked portion (e.g., tcp) should be
mitigated.

|*amsConfigPropertyName* |Name of AMS configuration property. AMS
specific – please refer to remarks below. |String

|*amsConfigPropertyValue* |Value of AMS configuration property. AMS
specific – please refer to remarks. |String

|*propertyName* |Name of a general configuration property. Please refer
to remarks. |String

|*propertyValue* |Name of a general configuration property. Please refer
to remarks. |String

|*netNodeLabel* |Label of a NetNode relevant to protection of this PN.
Please refer to remarks. |String
|=======================================================================

[[delete-pn]]
= Delete PN

*Description* – Delete a PN.

'''Syntax –

`'''controlapps removepn '''label '''( Command will require confirmation )`

*Result -*

`Are you sure you want to remove pn `*`label`*`? Please confirm with [yes, Yes or Y].`

*y*

Initiating removal of pn *label*

*Remarks* – PN removal is background process initiated by this command.
PN is not removed from DB but marked as canceled and is not processed by
Defense4all.

Success can be validated by Get PN command.

[cols=",,",]
|==========================================
|*Parameter* |*Description* |*Valid Value*
|*label* |PN label |String up to 256 bytes.
|==========================================

[[get-amss]]
= Get AMSs

*Description* – Get the configuration information of all AMSs.

'''Syntax '''-

`controlapps getamss`

_'Result *– AMS [*AMS_RECORD_']

*Remarks – none.*

[cols=",,",]
|========================================================
|*Result Element* |*Description* |*Valid Value*
|*AMS_RECORD* |AMS Information. See Get AMS for details |
|========================================================

[[get-amss-count]]
= Get AMSs Count

*Description* – Get the number of configured AMSs.

'''Syntax '''-

`controlapps getamsscount`

'''Result '''- There are *count* AMSs known to DF.

*Remarks* – none.

[cols=",,",]
|==============================================
|*Result Element* |*Description* |*Valid Value*
|*count* |The number of existing AMSs |Number
|==============================================

[[get-ams]]
= Get AMS

*Description* – Get the configuration information of an AMS.

'''Syntax '''-

`controlapps getams `*`label`*

*Result* - AMS[label=*label*, brand=*brand*, version=*version*,
mgmtAddr=*mgmtAddr*, mgmtPort=*mgmtPort*, username=*username*,
password=*password*, forStatsCollection=*forStatsCollection*,
forDiversion=*forDiversion*, healthCheckFrequency=healthCheckFrequency,
props=\{*propertyName*:*propertyValue*}]

*Remarks* - See remarks in Add AMS.

[cols=",,",]
|===========================================
|*Parameter* |*Description* |*Valid Value*
|*label* |AMS label |String up to 256 bytes.
|===========================================

[cols=",,",]
|=======================================================================
|*Result Element* |*Description* |*Valid Value*

|*label* |AMS label |String up to 256 bytes.

|*brand* |AMS brand |String up to 256 bytes.

|*version* |AMS version |String up to 256 bytes.

|*mgmtAddr* |AMS management address |String format compatible with Java
InetAddress.getByName(). If hostname is specified, then its IP address
is resolved. The address can also be specified as textual IP
representation (V4 or V6 format), or address number.

|*mgmtPort* |AMS management L4 port |Number

|*username* |Username used to communicate with AMS |String up to 256
bytes. Additional AMS specific limitations may apply.

|*password* |Password used to communicate with AMS |String up to 256
bytes. Additional AMS specific limitations may apply.

|*forStatsCollection* |Indicator whether this AMS is used at peace-time
for stats collection and attack detection - instead of ODC stats based
detection. |*true* | *false*

|*forDiversion* |Indicator whether this AMS is used for attack
mitigation (traffic diversion) |*true* | *false*

|*healthCheckFrequency* |Frequency to check health of this AMS – check
every '''healthCheckFrequency '''seconds |Number

|*propertyName* |Name of a configuration property. Please refer to
remarks. |String.

|*propertyValue* |Value of a configuration property. Please refer to
remarks. |String.
|=======================================================================

[[add-ams]]
= Add AMS

*Description* – Configure an AMS to Defense4All.

'''Syntax '''-

`controlapps addams label=`*`label`*` brand=`*`brand`*` version=`*`version`*` mgmtAddr=`*`mgmtAddr`*` mgmtPort=`*`mgmtPort`*` mgmtUsername='''mgmtUsername `*`mgmtPassword=`*`mgmtPassword '''` +
`forStatsCollection=`*`forStatsCollection`*`  forDiversion=`_`'forDiversion`
*`healthCheckFrequency=`*`healthCheckFrequency`_`' props::`*`propertyName`*`=`*`propertyValue`*`  `

'''Result '''- Confirmation or error message

*Remarks* –

1.  Configuration properties - Because AMS is a pluggable component, the
Defense4All general REST API must not include any component specific
configurations as named parameters in AMS. To allow configuration of
pluggable components the notion of configuration properties is used. Any
AMS specific configuration setup should be configured as a property
carrying a unique property name. *Props* are the optional configuration
properties of the AMS.
2.  An AMS may be connected to a NetNode via multiple input-output port
pairs. The can be done for enhanced availability or traffic isolation.
However the AMS label for each connection must be unique. Logically,
therefore, each AMS port-pair map to a separate AMS with its unique
label.

[cols=",,",]
|=======================================================================
|*Request Element* |*Description* |*Valid Value*

|*label* |AMS label |String up to 256 bytes.

|*brand* |AMS brand |String up to 256 bytes.

|*version* |AMS version |String up to 256 bytes.

|*mgmtAddr* |AMS management address |String format compatible with Java
InetAddress.getByName(). If hostname is specified, then its IP address
is resolved. The address can also be specified as textual IP
representation (V4 or V6 format), or address number.

|*mgmtPort* |AMS management L4 port |Number

|*mgmtUsername* |Username to be used communicating with AMS |String up
to 256 bytes. Additional AMS specific limitations may apply.

|*mgmtPassword* |Password to be used communicating with AMS |String up
to 256 bytes. Additional AMS specific limitations may apply.

|*forStatsCollection* |Indicator whether this AMS is to be used at
peace-time for stats collection and attack detection - instead of ODC
stats based detection. |*true* | *false*

|*forDiversion* |Indicator whether this AMS is to be used for attack
mitigation (traffic diversion) |*true* | *false*

|*healthCheckFrequency* |Frequency to check health of this AMS – check
every '''healthCheckFrequency '''seconds |Number

|*propertyName* |Name of a configuration property. Please refer to
remarks. |String.

|*propertyValue* |Value of a configuration property. Please refer to
remarks. |String.
|=======================================================================

[[delete-ams]]
= Delete AMS

*Description* – Delete an AMS.

'''Syntax –

*`controlapps`
`removeams`*` label '''( Command will require confirmation )`

*Result -*

`Are you sure you want to remove pn `*`label`*`? Please confirm with [yes, Yes or Y].`

*y*

Initiating removal of ams *label*

*Remarks* – AMS removal is background process initiated by this command.
AMS is not removed from DB but marked as canceled and is not processed
by Defense4all.

[cols=",,",]
|===========================================
|*Parameter* |*Description* |*Valid Value*
|*label* |AMS label |String up to 256 bytes.
|===========================================

[[get-netnodes]]
= Get NetNodes

*Description* – Get the configuration information of all NetNodes.

'''Syntax '''-

`controlapps getnetnodes`

_'Result *– NetNode [*NETNODE_RECORD_']

*Remarks – none.*

[cols=",,",]
|====================================================================
|*Result Element* |*Description* |*Valid Value*
|*NETNODE_RECORD* |NetNode Information. See Get NetNode for details |
|====================================================================

[[get-netnodes-count]]
= Get NetNodes Count

*Description* – Get the number of configured PNs.

'''Syntax '''-

`controlapps getnetnodescount`

'''Result '''- There are *count* netNodes known to DF.

*Remarks* – none.

[cols=",,",]
|================================================
|*Result Element* |*Description* |*Valid Value*
|*count* |The number of existing NetNodes |Number
|================================================

[[get-netnode]]
= Get NetNode

*Description* – Get the configuration information of a NetNode.

'''Syntax '''-

`controlapps getnetnode `*`label`*

*Result* - NetNode [label=*label*, id=*id*, type=*type*,
mgmtAddr=*mgmtAddr*, mgmtPort=*mgmtPort*, sdnNodeMode=*sdnNodeMode*,
healthCheckFrequency=*healthCheckFrequency*,
amsConnection=*amsConnectionsStr*, trafficPort=_' trafficPortsStr*,
protectedLink=* protectedLinksStr*,
props=\{*propertyName*:*propertyValue_'}]

*Remarks* –

1.  See remarks in Add NetNode.

[cols=",,",]
|===============================================
|*Parameter* |*Description* |*Valid Value*
|*label* |NetNode label |String up to 256 bytes.
|===============================================

[cols=",,",]
|=======================================================================
|*Result Element* |*Description* |*Valid Value*

|*label* |NetNode label |String up to 256 bytes.

|*id* |NetNode id. See remarks. |String up to 256 bytes.

|*type* |NetNode type. |*OF* – for ODC managed switches/routers

|*mgmtAddr* |NetNode management address |String format compatible with
Java InetAddress.getByName(). If hostname is specified, then its IP
address is resolved. The address can also be specified as textual IP
representation (V4 or V6 format), or address number.

|*mgmtPort* |NetNode management L4 port |Number

|*sdnNodeMode* |Mode of operation of this NetNode. See remarks.
|*sdnenablednative* | *sdnenabledhybrid*

|*healthCheckFrequency* |Frequency to check this NetNode’s health –
every '''healthCheckFrequency '''seconds |Number

|*status* |NetNode status indicating whether the NetNode is active or
has logically been removed (and appears only for recording and analysis
purposes). |*ACTIVE*|*REMOVED*

|*propertyName* |Name of a NetNode configuration property. Please refer
to remarks. |String.

|*propertyValue* |Value of a NetNode configuration property. Please
refer to remarks. |String.

|*amsConnectionStr* |Composite string. See format below a table |String

a|
*amsConnection*

*amsLabel*

 |Unique label of an AMS connected to this NetNode. Please see remarks.
|String

|*amsConnection netNodeNorthPort* |Id of the north port in the NetNode
connecting to the AMS. Defense4All redirects inbound traffic through
this port to the AMS, and returns (legitimate) outbound traffic to
clients. |String

|*amsConnection netNodeSouthPort* |Id of the south port in the NetNode
connecting to the AMS. Defense4All redirects outbound traffic through
this port to the AMS, and returns (legitimate) inbound traffic to
protected servers. |String

|*amsConnection amsNorthPort* |Id of the north port in the AMS
connecting to the netNodeNorthPort in the NetNode |String

|*amsConnection amsSouthPort* |Id of the north port in the AMS
connecting to the netNodeSouth in the NetNode |String

|*trafficPortStr* |Composite string. See format below a table |String

|*trafficPort label* |Unique label of a traffic port – port through
which inbound or outbound traffic enters the NetNode. |String

|*trafficPort number* |Unique number of a traffic port – port through
which inbound or outbound traffic enters the NetNode. |Number. 0 if
trafficPort number is not used (trafficPort label sufficient)

|*trafficPort vlan* |VLAN id associated with the trafficPort |Number

|*trafficPort location* |Location of the traffic port – north (client
side) or south (protected server side) |*north* | *south*

|*protectedLinkStr* |Composite string. See format below a table |String

|*protectedLink label* |Unique label of the protected link |String

|*protectedLink northPort* |North trafficPort of the protectedLink port
pair |Number

|*protectedLink southPort* |South trafficPort of the protectedLink port
pair |Number

|*protectedLink macOfConnectedToNorthPort* |MAC address of the L2
network element connected to the north port of protected link port-pair.
|String

| | |
|=======================================================================

'''Format of '''amsConnections, used in amsConnectionsStr –

image:ams_connections.jpg[AMS Connections,title="AMS Connections"]

`        For example – ams1:netnodePort1:netnodePort2:5:6::ams2:netnodePort3:netnodePort4:1:2 `

'''Format of '''trafficPorts, used in trafficPortStr –

image:traffic_ports.jpg[`Traffic` `Ports`,title="Traffic Ports"]

`        For example – trafficPort5:5:1020:north::trafficPort6:6:1030:south::trafficPort7:7:1040:north::trafficPort8:8:1050:south`

'''Format of '''protectedLinks, used in protectedLinksStr –

image:protected_links.jpg[`Protected` `Links`,title="Protected Links"]

`        For example – protectedLink56:5:6:0000005056a31b80:: protectedLink78:7:8:0000005056a31b81`

[[add-netnode]]
= Add NetNode

*Description* – Configure a NetNode in Defense4All.

*Syntax* -

*`controlapps` `addnetnode`
`label=`*`label''' id=`*`id`*` type=`*`type`*` mgmtAddr=`*`mgmtAddr`*` mgmtPort=`*`mgmtPort`*` sdnNodeMode=`*`sdnNodeMode`*`healthCheckFrequency=`*`healthCheckFrequency`* +
`amsConnection::amsLabel='''amsLabel `*`amsConnection::`*`amsLabel`*`::netNodeNorthPort=`*`netNodeNorthPort `*`amsConnection::`*`amsLabel`*`::netNodeSouthPort=`*`netNodeSouthPort '''` +
`amsConnection::`*`amsLabel`*`::amsNorthPort=`*`amsNorthPort`*` amsConnection::`*`amsLabel`*`::amsSouthPort='''amsSouthPort `*`trafficPort::label=`*`label `*`trafficPort::`*`label`*`::number=`*`number '''` +
`trafficPort::`*`label`*`::vlan='''vlan `*`trafficPort::`*`label`*`::location=`*`location `*`protectedLink::label=`*`label `*`protectedLink::`*`label`*`::northPort=`*`northPort '''` +
`protectedLink::`*`label`*`::southPort='''southPort ''' protectedLink::`*`label`*`::macOfConnectedToNorthPort=`*`macOfConnectedToNorthPort`*`props::`*`propertyName`*`=`*`propertyValue`*`  `

'''Result '''- Confirmation or error message

*Remarks* –

1.  Configuration properties - Because NetNode is a pluggable component
in nature, the Defense4All general REST API must not include any
component specific configurations as named parameters in NetNode. To
allow configuration of pluggable components the notion of configuration
properties is used. Any NetNode specific configuration setup should be
configured as a property carrying a unique property name. *Props* are
the optional configuration properties of the AMS.
2.  NetNode id field can mean different things in different kinds of
NetNodes. In SDN switches/routers this is the DPID. In virtual
environments, like VTN this is the VTN id. In other abstracted domains
of network control sphere this may be the id of the domain.
3.  SdnNodeMode and ProtectedLinks - ODL Reps supports two types of SDN
Switches: sdn-hybrid, which support both SDN and legacy routing, and
sdn-native, which supports SDN only routing. Counting traffic in
sdn-hybrid switch can be simply accomplished by programming a flow entry
with desired traffic selection criteria and the action is “send to
normal”, i.e., continue with legacy routing. Counting traffic in
sdn-native switch requires an explicit routing action (i.e., which
output port to send the traffic to). Defense4All avoids learning all
routing tables by requiring an sdn-native switch which is more or less a
bump-in the wire with respect to traffic routing, If a NetNode is
configured with switch entry-exit port pairs, say 1-2 and 3-4, then
traffic entering port 1 normally exits port 2 and traffic entering port
3 normally exits port 4 and vice versa. Such a switch allows for easy
programming of flow entries just to count traffic or to divert traffic
to/from attached AMS. So when Defense4All programs a traffic counting
flow entry with selection criteria that includes port 1, its action will
be output to port 2, and similarly with 3 to 4.
4.  An AMS may be connected to a NetNode via multiple input-output port
pairs. The can be done for enhanced availability or traffic isolation.
However the AMS label for each connection must be unique. Logically,
therefore, each AMS port-pair map to a separate AMS with its unique
label.

[cols=",,",]
|=======================================================================
|*Parameter* |*Description* |*Valid Value*

|*label* |NetNode label |String up to 256 bytes.

|*id* |NetNode id. See remarks. |String up to 256 bytes.

|*type* |NetNode type. |*OF* – for ODC managed switches/routers

|*mgmtAddr* |NetNode management address |String format compatible with
Java InetAddress.getByName(). If hostname is specified, then its IP
address is resolved. The address can also be specified as textual IP
representation (V4 or V6 format), or address number.

|*mgmtPort* |NetNode management L4 port |Number

|*sdnNodeMode* |Mode of operation of this NetNode. See remarks.
|*Sdnenablednative* | *sdnenabledhybrid*

|*healthCheckFrequency* |Frequency to check this NetNode’s health –
every '''healthCheckFrequency '''seconds |Number

|*propertyName* |Name of a NetNode configuration property. Please refer
to remarks. |String.

|*propertyValue* |Value of a NetNode configuration property. Please
refer to remarks. |String.

a|
*amsConnection*

*amsLabel*

 |Unique label of an AMS connected to this NetNode. Please see remarks.
|String

|*amsConnection netNodeNorthPort* |Id of the north port in the NetNode
connecting to the AMS. Defense4All redirects inbound traffic through
this port to the AMS, and returns (legitimate) outbound traffic to
clients. |String

|*amsConnection netNodeSouthPort* |Id of the south port in the NetNode
connecting to the AMS. Defense4All redirects outbound traffic through
this port to the AMS, and returns (legitimate) inbound traffic to
protected servers. |String

|*amsConnection amsNorthPort* |Id of the north port in the AMS
connecting to the netNodeNorthPort in the NetNode |String

|*amsConnection amsSouthPort* |Id of the north port in the AMS
connecting to the netNodeSouth in the NetNode |String

|*trafficPort label* |Unique label of a traffic port – port through
which inbound or outbound traffic enters the NetNode. |String

|*trafficPort number* |Unique number of a traffic port – port through
which inbound or outbound traffic enters the NetNode. |Number. 0 if
trafficPort number is not used (trafficPort label sufficient)

|*trafficPort vlan* |VLAN id associated with the trafficPort |Number

|*trafficPort location* |Location of the traffic port – north (client
side) or south (protected server side) |*north* | *south*

|*protectedLink label* |Unique label of the protected link |String

|*protectedLink northPort* |North trafficPort of the protectedLink port
pair |Number

|*protectedLink southPort* |South trafficPort of the protectedLink port
pair |Number

|*protectedLink macOfConnectedToNorthPort* |MAC address of the L2
network element connected to the north port of protected link port-pair.
Learned by Defense4All, so user can leave it blank |String
|=======================================================================

[[delete-netnode]]
= Delete NetNode

*Description* – Delete a NetNode.

'''Syntax –

`'''controlapps removenetnode  '''label '''( Command will require confirmation )`

*Result -*

`Are you sure you want to remove netnode `*`label`*`? Please confirm with [yes, Yes or Y].`

*y*

Initiating removal of netnode *label*

*Remarks* – NetNode removal is background process initiated by this
command. NetNode is not removed from DB but marked as canceled and is
not processed by Defense4all.

Success can be validated by Get NetNode command.

[cols=",,",]
|===============================================
|*Parameter* |*Description* |*Valid Value*
|*label* |NetNode label |String up to 256 bytes.
|===============================================

[[get-ofcs]]
= Get OFCs

*Description* – Get the configuration information of all ODCs. Currently
only one ODC can be used by Defense4All.

'''Syntax '''-

`controlapps getamss`

_'Result *– OFC [*OFC_RECORD]_'

*Remarks – none.*

[cols=",,",]
|========================================================
|*Result Element* |*Description* |*Valid Value*
|*OFC_RECORD* |ODC Information. See Get OFC for details |
|========================================================

[[get-ofc]]
= Get OFC

*Description* – Get the configuration information of an ODC.

'''Syntax '''-

`controlapps getofc `*`label`*

*Result* - OFC[hostname=*hostname*, username=*username*,
password=*password*, forStatsCollection=*forStatsCollection*,
ipAddrString=*ipAddrString*, port=*port*, forDiversion= *forDiversion*,
props=\{*propertyName* :_' propertyValue_'}]

*Remarks* - See remarks in Add OFC.

*Remarks* –

1.  See remarks in Add OFC.

[cols=",,",]
|===========================================
|*Parameter* |*Description* |*Valid Value*
|*label* |ODC label |String up to 256 bytes.
|===========================================

[cols=",,",]
|=======================================================================
|*Result Element* |*Description* |*Valid Value*

|*hostname* |ODC label |String up to 256 bytes.

|*ipAddrString* |ODC address used for programming the SDN. |String
format compatible with Java InetAddress.getByName(). If hostname is
specified, then its IP address is resolved. The address can also be
specified as textual IP representation (V4 or V6 format), or address
number.

|*port* |ODC L4 port used for programming the SDN |Number

|*username* |Username used to communicate with ODC |String up to 256
bytes. Additional ODC version specific limitations may apply.

|*password* |Password used to communicate with ODC |String up to 256
bytes. Additional ODC version specific limitations may apply.

|*forStatsCollection* |Indicator whether peace-time stats collection
should be set through this ODC. Currently must be true. |*true* |
('''false *currently* '''does not apply)

|*forDiversion* |Indicator whether attacked traffic redirection should
be set through this ODC. Currently must be true. |*true* | ('''false
*currently* '''does not apply)

|*propertyName* |Name of a configuration property. Please refer to
remarks. |String.

|*propertyValue* |Value of a configuration property. Please refer to
remarks. |String.
|=======================================================================

[[add-ofc]]
= Add OFC

*Description* – Configure an ODC to Defense4All.

'''Syntax '''-

`controlapps addofc hostname=`*`hostname`*` mgmtAddr=`*`mgmtAddr`*` mgmtPort=`*`mgmtPort`*` mgmtUsername='''mgmtUsername `*`mgmtPassword=`*`mgmtPassword '''` +
`forStatsCollection=`*`forStatsCollection`*`  forDiversion=`_`'forDiversion`
*`props::`*`propertyName`*`=`*`propertyValue`_`'  `

'''Result '''- Confirmation or error message

*Remarks* –

1.  Configuration properties - Because ODC is a pluggable component in
nature, the Defense4All general REST API must not include any component
specific configurations as named parameters in OFC. To allow
configuration of pluggable components the notion of configuration
properties is used. Any ODC version specific configuration setup should
be configured as a property carrying a unique property name. *Props* are
the optional configuration properties of the ODC.
2.  In this version only one ODC can be used by Defense4All.

[cols=",,",]
|=======================================================================
|*Parameter* |*Description* |*Valid Value*

|*hostname* |ODC label |String up to 256 bytes.

|*mgmtAddr* |ODC address to be used for programming the SDN. |String
format compatible with Java InetAddress.getByName(). If hostname is
specified, then its IP address is resolved. The address can also be
specified as textual IP representation (V4 or V6 format), or address
number.

|*mgmtPort* |ODC L4 port to be used for programming the SDN |Number

|*mgmtUsername* |Username to be used to communicate with ODC |String up
to 256 bytes. Additional ODC version specific limitations may apply.

|*mgmtPassword* |Password to be used to communicate with ODC |String up
to 256 bytes. Additional ODC version specific limitations may apply.

|*forStatsCollection* |Indicator whether peace-time stats collection
should be set through this ODC. Currently must be true. |*true* |
('''false *currently* '''does not apply)

|*forDiversion* |Indicator whether attacked traffic redirection should
be set through this ODC. Currently must be true. |*true* | ('''false
*currently* '''does not apply)

|*propertyName* |Name of a configuration property. Please refer to
remarks. |String.

|*propertyValue* |Value of a configuration property. Please refer to
remarks. |String.
|=======================================================================

[[delete-ofc]]
= Delete OFC

*Description* – Delete an ODC.

'''Syntax –

`'''controlapps removeofc '''label '''( Command will require confirmation )`

*Result -*

`Are you sure you want to remove ofc `*`label`*`? Please confirm with [yes, Yes or Y].`

*y*

Initiating removal of ofc *label*

*Remarks* – PN removal is background process initiated by this command.
PN is not removed from DB but marked as canceled and is not processed by
Defense4all.

[cols=",,",]
|===========================================
|*Parameter* |*Description* |*Valid Value*
|*label* |ODC label |String up to 256 bytes.
|===========================================

[[get-attacks]]
= Get Attacks

*Description* – Get the information about all Attacks.

'''Syntax '''-

`controlapps getattacks `

_'Result *– Attack [*ATTACK_RECORD_']

*Remarks* – none.

[cols=",,",]
|=================================================================
|*Result Element* |*Description* |*Valid Value*
|*ATTACK_RECORD* |Attack Information. See Get Attack for details |
|=================================================================

[[get-attack]]
= Get Attack

*Description* – Get all the information about an Attack.

'''Syntax '''-

`controlapps getattack `*`attackKey`*

_'Result *- Attack[key=*attackKey*, mitigationKey=*mitigationKey*,
protocolPort=*protocolPort*, status=*status_', detectionKeys=\{
*detectionKey*}]

*Remarks* –

1.  API to retrieve attack detections is to be exposed as API in future
releases.

[cols=",,",]
|==============================================================
|*Parameter* |*Description* |*Valid Value*
|*attackKey* |Unique Attack identifier |String up to 256 bytes.
|==============================================================

[cols=",,",]
|=======================================================================
|*Result Element* |*Description* |*Valid Value*

|*attackKey* |Unique Attack identifier |String up to 256 bytes.

|*pnKey* |Attacked PN label |String up to 256 bytes.

|*mitigationKey* |Unique identifier of the corresponding mitigation
record |String up to 256 bytes.

|*Status* |Status of the attack, reflecting attack lifecycle. a|
*SUSPECTED* – There is at least one attack suspicion (detection), but
the attack has not been declared yet.

*DECLARED* – The attack has been declared, and attack mitigation is
attempted.''' '''

*ENDING* – The attack is ending, and mitigation actions are being
canceled.''' '''

*ENDED* – The attack has ended, and all mitigation actions for this
attack ended too.

|*protocolPort* |Attacked protocol port |String. Format is protocol:port

|*protocolPort protocol* |Attacked protocol. |*TCP* | *UDP*| *ICMP* |
*OTHER* (rest of IP traffic)

|*protocolPort port* |Attacked L4 port of the attacked protocol (if
applicable). |Number. 0 if traffic of all ports is attacked.

|*detectionKey* |Unique identifier of a detection record of this attack.
Please see remarks. |String.
|=======================================================================

[[get-mitigations]]
= Get Mitigations

*Description* – Get all the information about all Attack Mitigations.

'''Syntax '''-

`controlapps getmitigations`

_'Result *– Mitigation [*MITIGATION_RECORD_']

*Remarks* – none.

[cols=",,",]
|=======================================================================
|*Result Element* |*Description* |*Valid Value*

|*MITIGATION_RECORD* |Attack Mitigation Information. See Get Mitigation
for details |
|=======================================================================

[[get-mitigation]]
= Get Mitigation

*Description* – Get all the information about an Attack Mitigation.

'''Syntax '''-

`controlapps getmitigation `*`mitigationKey`*

_'Result *– Mitigation[key=*mitigationKey*, attackKey=*attackKey*,
pnKey=*pnKey*, monitoredTrafficKey=*monitoredTrafficKey_', protocolPort=
*protocolPort*, status= *status*, dvsnInfoKeys=[ *dvsnInfoKey*]]

*Remarks* –

1.  Retrieving monitored traffic records is to be supported in future
releases.
2.  See trouble-shooting of mitigation status NO_RESOURCES.
3.  Diversion Info is to be retrievable in future releases.

[cols=",,",]
|======================================================================
|*Parameter* |*Description* |*Valid Value*
|*mitigationKey* |Unique Mitigation identifier |String up to 256 bytes.
|======================================================================

[cols=",,",]
|=======================================================================
|*Result Element* |*Description* |*Valid Value*

|*attackKey* |Unique Attack identifier |String up to 256 bytes.

|*pnKey* |Attacked PN label |String up to 256 bytes.

|*monitoredTrafficKey* |Unique Monitored Traffic record identifier.
Relevant only for debugging purposes. |String up to 256 bytes.

|*Status* |Status of the mitigation, reflecting mitigation lifecycle. a|
*ACTIVE* – One (or more) of the installed mitigation drivers drives this
mitigation.''' '''

*NO_RESOURCES* – No mitigation driver drives this mitigation. The reason
is either lack of resources relevant for this PN’s attack mitigation, or
some internal failure in the mitigation process.''' '''

*ENDED* – All mitigation actions for the corresponding attack have
ended.

|*protocolPort* |Attacked protocol port |String. Format is protocol:port

|*protocolPort protocol* |Mitigated protocol. '''Invalid ''' means all
traffic of the PN is mitigated (whether attacked or not). |*INVALID |
TCP* | *UDP*| *ICMP* | *OTHER* (rest of IP traffic)

|*protocolPort port* |Mitigated L4 port in the mitigated protocol (if
applicable). |Number. 0 if traffic of all ports is mitigated

|*dvsnInfoKey* |Unique identifier of each traffic diversion information,
focusing on the AMS devices to which traffic has been diverted, and any
special configuration performed on those AMS devices for this
mitigation. |String up to 256 bytes.
|=======================================================================

Back to Defense4All:User_Guide[Defense4All User Guide Page]
